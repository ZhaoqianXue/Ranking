# é²æ£’æ’åºæ¡†æ¶ (Robust Ranking Framework)

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªç»Ÿè®¡æ¡†æ¶ï¼Œæ—¨åœ¨æ ¹æ®å¤šä¸ªæ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹ã€æ²»ç–—æ–¹æ¡ˆï¼‰åœ¨ä¸€ç³»åˆ—æ ·æœ¬æˆ–è¯„ä¼°æ¡ˆä¾‹ä¸Šçš„è¡¨ç°è¿›è¡Œé²æ£’æ’åºï¼Œå¹¶é‡åŒ–è¯¥æ’åºç»“æœçš„ä¸ç¡®å®šæ€§ã€‚è¯¥æ¡†æ¶çš„æ ¸å¿ƒæ˜¯ **Vanilla Spectral Method**ï¼Œå®ƒä¸ä»…èƒ½æä¾›æœ€ç»ˆæ’åï¼Œè¿˜èƒ½é€šè¿‡ç½®ä¿¡åŒºé—´æ¥è¯„ä¼°æ’åçš„å¯é æ€§ã€‚

## 1. æ ¸å¿ƒæ–¹æ³•è®º

æ’åºè¿‡ç¨‹åŸºäºå¯¹æ¯ä¸ªæ ·æœ¬ä¸­æ–¹æ³•ä¹‹é—´çš„æˆå¯¹æ¯”è¾ƒåˆ†æã€‚

### 1.1. æ•°æ®é¢„å¤„ç† ( `process_data` å‡½æ•°)

è¾“å…¥æ•°æ®é¦–å…ˆè¢«è½¬æ¢ä¸ºå›¾çš„è¡¨ç¤ºå½¢å¼ã€‚

-   **è¾“å…¥**: ä¸€ä¸ªæ•°æ®çŸ©é˜µï¼Œå…¶ä¸­è¡Œä»£è¡¨æ ·æœ¬ï¼Œåˆ—ä»£è¡¨æ–¹æ³•ã€‚
-   **è¿‡ç¨‹**: å¯¹äºæ¯ä¸ªæ ·æœ¬ï¼Œæ‰€æœ‰å¯ç”¨çš„æ–¹æ³•å¯¹éƒ½ä¼šè¢«è¿›è¡Œæ¯”è¾ƒã€‚æ ¹æ®å®ƒä»¬çš„æ€§èƒ½å¾—åˆ†ï¼ˆæ¯”è¾ƒçš„æ–¹å‘ç”± `bigbetter` å‚æ•°æ§åˆ¶ï¼‰ï¼Œç¡®å®šâ€œèƒœè€…â€å’Œâ€œè´¥è€…â€ã€‚
-   **è¾“å‡º**: æ‰€æœ‰æ ·æœ¬çš„æˆå¯¹æ¯”è¾ƒç»“æœè¢«æ±‡æ€»ä¸ºçŸ©é˜µï¼ˆ`aa` å’Œ `ww`ï¼‰ï¼Œè¿™äº›çŸ©é˜µæ„æˆäº†è°±æ’åºç®—æ³•çš„åŸºç¡€ã€‚

### 1.2. Vanilla Spectral Method ( `vanilla_spectrum_method` å‡½æ•°)

è¿™æ˜¯ç”¨äºæ’åºå’Œä¸ç¡®å®šæ€§ä¼°è®¡çš„æ ¸å¿ƒç®—æ³•ã€‚

-   **æ’åº**: ç®—æ³•æ ¹æ®æ¯”è¾ƒæ•°æ®æ„å»ºä¸€ä¸ªè½¬ç§»çŸ©é˜µ `P`ã€‚ç„¶åï¼Œè®¡ç®—ç”± `P` æ‰€ä»£è¡¨çš„é©¬å°”å¯å¤«é“¾çš„å¹³ç¨³åˆ†å¸ƒã€‚è¯¥åˆ†å¸ƒçš„å…ƒç´ ä½œä¸ºæ¯ç§æ–¹æ³•çš„â€œèƒ½åŠ›å¾—åˆ†â€ (`theta.hat`)ã€‚æœ€ç»ˆæ’åç”±è¿™äº›å¾—åˆ†å¯¼å‡ºã€‚
-   **ä¸ç¡®å®šæ€§é‡åŒ–**: ä¸ºäº†è¯„ä¼°æ’åçš„ç¨³å®šæ€§ï¼Œè¯¥æ¡†æ¶ä½¿ç”¨äº† **åŠ æƒè‡ªåŠ©æ³• (Weighted Bootstrap)**ã€‚é€šè¿‡é‡å¤é‡é‡‡æ ·å¹¶é‡æ–°è®¡ç®—æ’åï¼ˆä¾‹å¦‚ï¼Œ2000æ¬¡ï¼‰ï¼Œå®ƒä¸ºæ¯ç§æ–¹æ³•çš„æ’åæ„å»ºäº†ç»éªŒåˆ†å¸ƒã€‚ä»è¿™äº›åˆ†å¸ƒä¸­ï¼Œå®ƒè®¡ç®—å‡ºå‡ ç§ç±»å‹çš„ç½®ä¿¡åŒºé—´ã€‚

## 2. è¾“å‡ºç»“æœè§£è¯»

æœ€ç»ˆè¾“å‡ºæ˜¯ä¸€ä¸ªæ€»ç»“æ’åºç»“æœçš„çŸ©é˜µã€‚è¯¥çŸ©é˜µçš„è¡Œä»£è¡¨ï¼š

-   `theta.hat`: é€šè¿‡è°±æ–¹æ³•è®¡ç®—å‡ºçš„åŸå§‹èƒ½åŠ›å¾—åˆ†ã€‚å¾—åˆ†è¶Šé«˜ï¼Œè¡¨ç¤ºæ€§èƒ½è¶Šå¥½ã€‚
-   `Ranking`: æ¯ç§æ–¹æ³•çš„æœ€ç»ˆæ’åï¼Œä»ç¬¬1åï¼ˆæœ€å¥½ï¼‰åˆ°ç¬¬kåï¼ˆæœ€å·®ï¼‰ã€‚
-   `two-sided CI`: æ’åçš„95%åŒè¾¹ç½®ä¿¡åŒºé—´ã€‚ä¾‹å¦‚ï¼Œ`[1, 3]` çš„åŒºé—´è¡¨ç¤ºæˆ‘ä»¬æœ‰95%çš„ä¿¡å¿ƒè®¤ä¸ºè¯¥æ–¹æ³•çš„çœŸå®æ’ååœ¨ç¬¬1åˆ°ç¬¬3åä¹‹é—´ã€‚
-   `left-sided CI`: æ’åçš„95%å•è¾¹ç½®ä¿¡åŒºé—´ï¼ˆä¸‹é™ï¼‰ã€‚è¿™æä¾›äº†ä¸€ä¸ªå…³äºæœ€ä½³å¯èƒ½æ’åçš„ä¿å®ˆä¼°è®¡ã€‚ä¾‹å¦‚ï¼Œå€¼ä¸º2æ„å‘³ç€æˆ‘ä»¬æœ‰95%çš„ä¿¡å¿ƒè®¤ä¸ºè¯¥æ–¹æ³•çš„çœŸå®æ’åä¸ä¼šå¥½äºç¬¬2åï¼ˆå³æ’åå¯èƒ½æ˜¯2, 3, 4, ...ï¼‰ã€‚
-   `uniform left-sided CI`: ä¸€ä¸ªæ›´ä¿å®ˆçš„ã€ç»Ÿä¸€çš„å•è¾¹ç½®ä¿¡åŒºé—´ï¼Œå®ƒä»¥95%çš„ç½®ä¿¡åº¦åŒæ—¶å¯¹æ‰€æœ‰æ–¹æ³•æˆç«‹ã€‚

## 3. å¦‚ä½•ä½¿ç”¨

é¡¹ç›®ä¸­åŒ…å«ä¸€ä¸ªæ¼”ç¤º R è„šæœ¬æ–‡ä»¶ `demo_r/demo.25.9.27.R`ï¼Œå®ƒå±•ç¤ºäº†å®Œæ•´çš„å·¥ä½œæµç¨‹ã€‚

### 3.1. è¾“å…¥æ•°æ®

è¾“å…¥åº”ä¸ºä¸€ä¸ª CSV æ–‡ä»¶ï¼Œå…¶ä¸­ï¼š
-   æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ ·æœ¬ã€æ¡ˆä¾‹æˆ–è¯•éªŒã€‚
-   æ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªå¾…æ’åºçš„æ–¹æ³•ã€‚
-   å•å…ƒæ ¼ä¸­çš„å€¼æ˜¯æ¯ç§æ–¹æ³•åœ¨æ¯ä¸ªæ ·æœ¬ä¸Šçš„æ€§èƒ½æŒ‡æ ‡ã€‚
-   ç¼ºå¤±å€¼ (`NA`) ä¼šè¢«è‡ªåŠ¨å¤„ç†ã€‚

### 3.2. è¿è¡Œæ¼”ç¤º

-   `demo_r/demo.25.9.27.R` è„šæœ¬å±•ç¤ºäº†ä¸‰ä¸ªç¤ºä¾‹ï¼š
1.  **æ¨¡æ‹Ÿæ•°æ®**: å®ƒé¦–å…ˆç”Ÿæˆä¸€ä¸ª `demo_r/simulated_data.csv` æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å·²çŸ¥çš„çœŸå®æ’åï¼Œç”¨äºéªŒè¯ç®—æ³•çš„æ­£ç¡®æ€§ã€‚
2.  **çœŸå®ä¸–ç•Œæœºå™¨å­¦ä¹ æ¨¡å‹æ¯”è¾ƒ (AoU)**: å®ƒæ ¹æ® `demo_r/top2000childrencode_report_aou.csv` æ•°æ®é›†å¯¹å‡ ç§æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½è¿›è¡Œæ’åã€‚
3.  **çœŸå®ä¸–ç•Œæœºå™¨å­¦ä¹ æ¨¡å‹æ¯”è¾ƒ (UKBB)**: å®ƒä½¿ç”¨ `demo_r/top2000childrencode_report_ukbb.csv` æ•°æ®é›†æ‰§è¡Œç±»ä¼¼çš„æ’åã€‚

-   `demo_r/simulated_data.csv`: ç”¨äºæµ‹è¯•ç›®çš„çš„äººå·¥ç”Ÿæˆæ•°æ®ã€‚
-   `demo_r/top2000childrencode_report_aou.csv`: æ¥è‡ª All of Us (AoU) æ•°æ®é›†çš„çœŸå®ä¸–ç•Œæ¨¡å‹æ€§èƒ½æ•°æ®ã€‚
-   `demo_r/top2000childrencode_report_ukbb.csv`: æ¥è‡ª UK Biobank (UKBB) æ•°æ®é›†çš„çœŸå®ä¸–ç•Œæ¨¡å‹æ€§èƒ½æ•°æ®ã€‚

## 4. Technical Architecture

### 4.1. æŠ€æœ¯æ ˆï¼š
å‰ç«¯ç•Œé¢ï¼šNiceGUIï¼›
åç«¯æœåŠ¡ï¼šPython FastAPIï¼›
Report_Generator_Agentæ•°æ®å¯è§†åŒ–ï¼šJavaScript (e.g. D3.js) (ç”¨äºç”Ÿæˆäº¤äº’å¼å’Œç¾è§‚çš„æŠ¥å‘Šå›¾è¡¨)ï¼›
Rè„šæœ¬è¿è¡Œç¯å¢ƒï¼šä½¿ç”¨ rpy2 è°ƒç”¨å½“å‰ Conda ç¯å¢ƒä¸­çš„ R æ¥æ‰§è¡Œ R è„šæœ¬ã€‚
è¦è¿è¡Œåˆ†æï¼Œåªéœ€åœ¨ R Markdown æ–‡ä»¶ä¸­æ‰§è¡Œä»£ç å—å³å¯ã€‚
LLM Agentï¼šé›†æˆOpenAI GPTç³»åˆ—æ¨¡å‹ï¼Œå®ç°æ™ºèƒ½å¯¹è¯å¼ç”¨æˆ·äº¤äº’ï¼Œæä¾›è‡ªç„¶è¯­è¨€å‚æ•°é…ç½®å’Œå®æ—¶è¿›åº¦åé¦ˆ

### 4.2. å‰åç«¯æ¶æ„ä¼˜åŒ–

#### æ¶æ„æ”¹è¿›ï¼š
- **å‰åç«¯åˆ†ç¦»**: å‰ç«¯é€šè¿‡HTTP APIè°ƒç”¨åç«¯ï¼Œä¸å†ç›´æ¥å¯¼å…¥åç«¯æ¨¡å—
- **ä¾èµ–è§£è€¦**: å‰ç«¯ä¸å†éœ€è¦å®‰è£…Rç¯å¢ƒï¼Œåç«¯ç‹¬ç«‹ç®¡ç†Rä¾èµ–

#### åç«¯APIç«¯ç‚¹ï¼š
- æ–°å¢ `/api/ranking/custom` ç«¯ç‚¹å¤„ç†è‡ªå®šä¹‰æ¨¡å‹æ’åè¯·æ±‚
- æ”¯æŒFormæ•°æ®æ ¼å¼ï¼š`model_name` å’Œ `scores` (JSONå­—ç¬¦ä¸²)

#### å‰ç«¯ä¼˜åŒ–ï¼š
- ç§»é™¤ç›´æ¥å¯¼å…¥ `run_custom_ranking` å‡½æ•°
- æ”¹ä¸ºä½¿ç”¨ `aiohttp` é€šè¿‡HTTP APIè°ƒç”¨åç«¯
- å‰ç«¯å¯åŠ¨è„šæœ¬ä¸å†å®‰è£…RåŒ…ï¼Œå¯åŠ¨æ—¶é—´å¤§å¹…ç¼©çŸ­

#### åç«¯éƒ¨ç½²ä¼˜åŒ–ï¼š
**å¿…éœ€çš„ç³»ç»Ÿä¾èµ–ï¼š**
- **R ç¯å¢ƒ**: `r-base`, `r-base-dev` - ç”¨äºè°±æ’åºç®—æ³•æ‰§è¡Œ
- **R åŒ…**: `readr`, `dplyr`, `jsonlite` - Rè„šæœ¬æ ¸å¿ƒä¾èµ–
- **ç¼–è¯‘å·¥å…·**: `libcurl4-openssl-dev`, `libssl-dev`, `libxml2-dev` - RåŒ…ç¼–è¯‘ä¾èµ–

**å·²ç§»é™¤çš„ä¸å¿…è¦ä¾èµ–ï¼š**
- `libgomp1` - OpenMPå¹¶è¡Œåº“ï¼ˆåç«¯ä¸éœ€è¦ï¼‰
- GTKå›¾å½¢ç•Œé¢åº“ï¼ˆåç«¯æ˜¯APIæœåŠ¡ï¼Œæ— GUIï¼‰
- X11æ˜¾ç¤ºç³»ç»Ÿï¼ˆåç«¯ä¸æ˜¾ç¤ºç•Œé¢ï¼‰
- OpenGL/Vulkanå›¾å½¢åº“ï¼ˆåç«¯ä¸éœ€è¦GPUæ¸²æŸ“ï¼‰
- ç»ˆç«¯æ¨¡æ‹Ÿå™¨ç­‰

**RåŒ…ä¼˜åŒ–ï¼š**
- ç§»é™¤äº† `MASS`, `Matrix`, `stats4` åŒ…ï¼ˆä¸R 4.0.4ç‰ˆæœ¬ä¸å…¼å®¹ï¼‰
- åªä¿ç•™å®é™…ä½¿ç”¨çš„ `readr`, `dplyr`, `jsonlite` åŒ…

## 5. LLM Performance Dashboard

LLM Performance Dashboardæ˜¯é›†æˆåˆ°ç°æœ‰Webç•Œé¢ä¸­çš„ä¸€ä¸ªæ–°åŠŸèƒ½æ¨¡å—ï¼Œç”¨äºå®æ—¶ç›‘æ§å’Œåˆ†æLLMæ¨¡å‹æ€§èƒ½ã€‚

### 5.1. æ•°æ®æ”¶é›†å™¨ (huggingface_data_collector.py)

`huggingface_data_collector.py` æ˜¯ä¸€ä¸ªä¸“é—¨çš„æ•°æ®æ”¶é›†å’Œé¢„å¤„ç†è„šæœ¬ï¼Œç”¨äºä»Hugging Faceçš„Open LLM Leaderboardè·å–LLMæ€§èƒ½æ•°æ®ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºé€‚åˆè°±æ’åºåˆ†æçš„æ ¼å¼ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- ä» [Open LLM Leaderboard Dataset](https://huggingface.co/datasets/open-llm-leaderboard/contents) è‡ªåŠ¨ä¸‹è½½æœ€æ–°æ•°æ®
- ç­›é€‰å’Œæ¸…æ´—æ•°æ®ï¼Œåªä¿ç•™å¯¹è°±æ’åºæœ‰ç”¨çš„åˆ—
- ç”Ÿæˆæ ‡å‡†åŒ–çš„CSVæ ¼å¼æ•°æ®ä¾›åç»­åˆ†æ

Output File: `llm_leaderboard_cleaned.csv` Schemaï¼š

**æ ¸å¿ƒBenchmarkåˆ†æ•°ï¼ˆ6åˆ—ï¼‰**ï¼š
- `ifeval` (float): **IFEvalæŒ‡ä»¤éµå¾ªè¯„ä¼°åˆ†æ•°** - æµ‹è¯•æ¨¡å‹å¯¹å¤æ‚ã€ç²¾ç¡®æŒ‡ä»¤çš„éµå¾ªèƒ½åŠ›ï¼ŒåŒ…æ‹¬æ¡ä»¶æ‰§è¡Œã€å¤šæ­¥éª¤ä»»åŠ¡å’Œæ ¼å¼è¦æ±‚ç­‰ã€‚è¡¡é‡æ¨¡å‹æ˜¯å¦èƒ½å‡†ç¡®ç†è§£å’Œæ‰§è¡Œè¯¦ç»†çš„æŒ‡ä»¤ã€‚
- `bbh` (float): **BBH (Big Bench Hard) å¤§å‹åŸºå‡†æµ‹è¯•åˆ†æ•°** - æ¥è‡ªGoogle BIG-Benché¡¹ç›®çš„å›°éš¾ä»»åŠ¡é›†åˆï¼Œæ¶µç›–é€»è¾‘æ¨ç†ã€æ•°å­¦ã€å¸¸è¯†æ¨ç†ç­‰å¤šç§æŒ‘æˆ˜æ€§ä»»åŠ¡ã€‚ä»£è¡¨æ¨¡å‹åœ¨å¤æ‚æ¨ç†ä»»åŠ¡ä¸Šçš„è¡¨ç°ã€‚
- `math` (float): **MATH Lvl 5æ•°å­¦æ¨ç†åˆ†æ•°** - äº”çº§éš¾åº¦çš„æ•°å­¦é—®é¢˜æ±‚è§£èƒ½åŠ›æµ‹è¯•ï¼Œæ¶µç›–ä»£æ•°ã€å‡ ä½•ã€å¾®ç§¯åˆ†ç­‰é«˜çº§æ•°å­¦æ¦‚å¿µã€‚åæ˜ æ¨¡å‹åœ¨ä¸¥è°¨æ•°å­¦æ¨ç†æ–¹é¢çš„å®åŠ›ã€‚
- `gpqa` (float): **GPQAç ”ç©¶ç”Ÿçº§é—®é¢˜å›ç­”åˆ†æ•°** - Graduate-level Google-Proof Q&Aï¼Œä¸“é—¨è®¾è®¡ç”¨äºåŒºåˆ†äººç±»ä¸“å®¶å’ŒAIæ¨¡å‹çš„é—®é¢˜ã€‚æµ‹è¯•æ¨¡å‹åœ¨ä¸“ä¸šé¢†åŸŸçŸ¥è¯†å’Œæ¨ç†ä¸Šçš„æ·±åº¦ã€‚
- `musr` (float): **MUSRå¤šæ­¥æ¨ç†ä»»åŠ¡åˆ†æ•°** - Multi-Step Unified Reasoningï¼Œæµ‹è¯•æ¨¡å‹è¿›è¡Œå¤šæ­¥éª¤é€»è¾‘æ¨ç†å’Œé—®é¢˜åˆ†è§£çš„èƒ½åŠ›ã€‚è¦æ±‚æ¨¡å‹èƒ½è¿›è¡Œè¿è´¯çš„æ¨ç†é“¾å¹¶å¾—å‡ºæ­£ç¡®ç»“è®ºã€‚
- `mmlu_pro` (float): **MMLU-PROä¸“ä¸šçº§çŸ¥è¯†æµ‹è¯•åˆ†æ•°** - MMLUçš„å¢å¼ºç‰ˆæœ¬ï¼Œä½¿ç”¨æ›´å…·æŒ‘æˆ˜æ€§çš„é—®é¢˜å’Œæ›´ä¸¥æ ¼çš„è¯„ä¼°æ ‡å‡†ã€‚æµ‹è¯•æ¨¡å‹åœ¨57ä¸ªå­¦ç§‘çš„ä¸“ä¸šçŸ¥è¯†æŒæ¡ç¨‹åº¦ã€‚

**æ¨¡å‹å…ƒæ•°æ®ï¼ˆ9åˆ—ï¼‰**ï¼š
- `model` (string): æ¨¡å‹å…¨åï¼ˆä¸»è¦æ ‡è¯†ç¬¦ï¼‰
- `model_link` (string): HuggingFaceæ¨¡å‹é¡µé¢HTMLé“¾æ¥
- `average_score` (float): å¹³å‡ç»¼åˆå¾—åˆ†
- `params_b` (float): å‚æ•°æ•°é‡
- `architecture` (string): æ¨¡å‹æ¶æ„ç±»å‹
- `precision` (string): **æ¨¡å‹æƒé‡çš„æ•°æ®ç±»å‹** - å†³å®šæ¨¡å‹å‚æ•°çš„æ•°å€¼è¡¨ç¤ºç²¾åº¦ã€‚å¸¸è§ç±»å‹åŒ…æ‹¬ï¼š`float32`ï¼ˆæ ‡å‡†32ä½æµ®ç‚¹ï¼‰ã€`float16`ï¼ˆåŠç²¾åº¦ï¼Œå¯å‡å°‘å†…å­˜ä½¿ç”¨ï¼‰ã€`bfloat16`ï¼ˆGoogleè®¾è®¡çš„16ä½æ ¼å¼ï¼‰ã€`int8/int4`ï¼ˆé‡åŒ–æ ¼å¼ï¼Œå‹ç¼©æ¨¡å‹å¤§å°ï¼‰ç­‰ã€‚å½±å“æ¨¡å‹å¤§å°ã€æ¨ç†é€Ÿåº¦å’Œå†…å­˜å ç”¨ã€‚
- `type` (string): æ¨¡å‹ç±»å‹ï¼ˆé¢„è®­ç»ƒ/å¾®è°ƒ/èŠå¤©æ¨¡å‹ç­‰ï¼‰
- `submission_date` (string): æäº¤æ—¥æœŸ
- `base_model` (string): åŸºç¡€æ¨¡å‹åç§°

**æ•°æ®è´¨é‡ä¿è¯**ï¼š
- æ‰€æœ‰benchmarkåˆ†æ•°ä¸º**å‡†ç¡®ç‡ç™¾åˆ†æ¯”ï¼ˆ0.0-100.0ï¼‰** - ç›´æ¥è¡¨ç¤ºæ¨¡å‹åœ¨ç›¸åº”ä»»åŠ¡ä¸Šçš„æ­£ç¡®ç‡ï¼Œä¾‹å¦‚82.5è¡¨ç¤º82.5%çš„å‡†ç¡®ç‡
- è‡ªåŠ¨è¿‡æ»¤ç¼ºå¤±benchmarkæ•°æ®çš„æ¨¡å‹
- æŒ‰å¹³å‡å¾—åˆ†é™åºæ’åºï¼Œæœ€ä¼˜æ¨¡å‹æ’åœ¨å‰é¢
- åŒ…å«çº¦4,576ä¸ªç»è¿‡éªŒè¯çš„LLMæ¨¡å‹è®°å½•

### 5.2. æ•°æ®å¤„ç†æµç¨‹ (huggingface_data_process.py)

`huggingface_data_process.py` è„šæœ¬å°†æ”¶é›†åˆ°çš„LLMæ•°æ®è½¬æ¢ä¸º`ranking_cli.R`æœŸæœ›çš„æ ¼å¼ï¼š

**è¾“å…¥æ ¼å¼**ï¼ˆæ¥è‡ª`huggingface_data_collector.py`ï¼‰ï¼š
- è¡Œï¼šLLMæ¨¡å‹ï¼ˆ4,576ä¸ªï¼‰
- åˆ—ï¼šBenchmarkåˆ†æ•° + å…ƒæ•°æ®ï¼ˆ15åˆ—ï¼‰

**è¾“å‡ºæ ¼å¼**ï¼ˆä¾›è°±æ’åºåˆ†æï¼‰ï¼š
- è¡Œï¼šBenchmarkä»»åŠ¡ï¼ˆ6ä¸ªï¼šIFEval, BBH, MATH, GPQA, MUSR, MMLU-PROï¼‰
- åˆ—ï¼šLLMæ¨¡å‹ï¼ˆTop Nä¸ªï¼ŒæŒ‰å¹³å‡å¾—åˆ†æ’åºï¼‰

**è‡ªåŠ¨ç”Ÿæˆçš„æ•°æ®é›†**ï¼š
- `llm_ranking_full.csv`: å…¨é‡æ•°æ®ï¼ˆ6Ã—4,576ï¼‰
- `llm_ranking_top25.csv`: Top 25æ¨¡å‹ï¼ˆ6Ã—25ï¼‰- å¿«é€Ÿæµ‹è¯•
- `llm_ranking_top50.csv`: Top 50æ¨¡å‹ï¼ˆ6Ã—50ï¼‰- ä¸­ç­‰è§„æ¨¡
- `llm_ranking_top100.csv`: Top 100æ¨¡å‹ï¼ˆ6Ã—100ï¼‰- æ¨èç”¨äºè°±æ’åºåˆ†æ

åŸºäºB=2000æ¬¡bootstrapé‡é‡‡æ ·çš„è°±æ’åºåˆ†æè¿è¡Œæ—¶é—´ï¼š

| æ•°æ®é›†è§„æ¨¡ | çŸ©é˜µç»´åº¦ | è¿è¡Œæ—¶é—´ | ç›¸å¯¹æ—¶é—´ |
|-----------|---------|---------|---------|
| **Top 25** | 6Ã—25 | **1.01ç§’** | 1x |
| **Top 50** | 6Ã—50 | **5.09ç§’** | 5.0x |
| **Top 100** | 6Ã—100 | **33.0ç§’** | 32.7x |

### 5.3. Dashboardæ•°æ®æ›´æ–°è„šæœ¬ (huggingface_ranking.py)

`huggingface_ranking.py` æ˜¯ä¸€ä¸ªä¸“é—¨çš„è„šæœ¬ï¼Œç”¨äºè¿è¡Œè°±æ’åºç®—æ³•å¹¶æ›´æ–°dashboardçš„æ•°æ®æ–‡ä»¶ã€‚å®ƒå°†é™æ€çš„LLMæ€§èƒ½æ•°æ®è½¬æ¢ä¸ºåŸºäºè°±æ’åºç®—æ³•çš„åŠ¨æ€æ’åã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- è‡ªåŠ¨è°ƒç”¨è°±æ’åºç®—æ³•å¯¹LLMæ•°æ®è¿›è¡Œæ’å
- å¤„ç†Rè„šæœ¬è¾“å‡ºæ ¼å¼å¹¶è½¬æ¢ä¸ºdashboardå…¼å®¹æ ¼å¼
- æ›´æ–° `llm_ranking_top100.csv` æ–‡ä»¶ï¼Œå®ç°å®æ—¶æ’åæ›´æ–°

**ä½¿ç”¨æ–¹æ³•**ï¼š

```bash
# æ›´æ–°top 100æ¨¡å‹çš„æ’åï¼ˆæ¨èç”¨äºå®Œæ•´åˆ†æï¼‰
python code_app/backend/data_ranking/huggingface_ranking.py --top-n 100 --B 2000

# å¿«é€Ÿæµ‹è¯•ä½¿ç”¨top 25æ¨¡å‹
python code_app/backend/data_ranking/huggingface_ranking.py --top-n 25 --B 100

# è‡ªå®šä¹‰å‚æ•°
python code_app/backend/data_ranking/huggingface_ranking.py \
  --top-n 50 \
  --bigbetter 1 \
  --B 1000 \
  --seed 123
```

**å‚æ•°è¯´æ˜**ï¼š
- `--top-n`: è¦æ’åçš„æ¨¡å‹æ•°é‡ (é»˜è®¤: 100)
- `--bigbetter`: æ›´é«˜åˆ†æ•°æ˜¯å¦æ›´å¥½ (1=æ˜¯, 0=å¦) (é»˜è®¤: 1)
- `--B`: Bootstrapè¿­ä»£æ¬¡æ•° (é»˜è®¤: 2000)
- `--seed`: éšæœºç§å­ (é»˜è®¤: 42)

**è¾“å‡º**ï¼š
- æ›´æ–° `data_llm/llm_ranking_top100.csv` æ–‡ä»¶
- è‡ªåŠ¨å¤‡ä»½åŸæœ‰æ–‡ä»¶ä¸º `.backup` åç¼€
- æ˜¾ç¤ºæ’åå‰5çš„æ¨¡å‹åŠå…¶è¯„åˆ†

**æ€§èƒ½å‚è€ƒ**ï¼ˆåŸºäºTop 100æ¨¡å‹ï¼‰ï¼š
- Bootstrap 500æ¬¡: ~25ç§’
- Bootstrap 2000æ¬¡: ~1.5-2åˆ†é’Ÿ
- Bootstrap 5000æ¬¡: ~5-6åˆ†é’Ÿ

### 5.4. ranking_cli.Rç®—æ³•æ—¶é—´å¤æ‚åº¦åˆ†æï¼ˆåŸºäºå®æµ‹æ•°æ®ï¼‰

åŸºäºè¯¦ç»†çš„æ—¶é—´æµ‹é‡è„šæœ¬(`ranking_cli_timing.R`)ï¼Œå¯¹ä¸åŒè§„æ¨¡æ•°æ®é›†è¿›è¡Œç²¾ç¡®çš„æ—¶é—´å¤æ‚åº¦åˆ†æï¼š

##### å®æµ‹æ—¶é—´åˆ†å¸ƒå¯¹æ¯”

| æ•°æ®é›†è§„æ¨¡         |   æ€»æ—¶é—´   |  IOæ—¶é—´  |   é¢„å¤„ç†   |  çŸ©é˜µæ„å»º  |   SVDåˆ†è§£   |  Bootstrap | Uniform CI |è°±æ’åºå æ¯”|
|-------------------|-----------|---------|---------|-----------|-----------|-----------|-----------|-----------|
| **Top 25** (n=25) | **1.01ç§’** | 0.18ç§’  | 0.07ç§’  | **0.07ç§’** | **0.003ç§’** | **0.35ç§’** | **0.26ç§’** | 69.4%  |
| **Top 50** (n=50) | **5.09ç§’** | 0.26ç§’  | 0.42ç§’  | **1.40ç§’** | **0.017ç§’** | **1.59ç§’** | **1.19ç§’** | 82.4%  |
| **Top 100** (n=100)| **33.0ç§’**| 0.23ç§’  | 0.92ç§’  | **17.7ç§’** | **0.041ç§’** | **7.13ç§’** | **6.41ç§’** | 94.9%  |

##### è¯¦ç»†æ€§èƒ½ç‰¹å¾åˆ†æ

**1. SVDåˆ†è§£æ€§èƒ½ç‰¹å¾**ï¼š
- **å®é™…å¤æ‚åº¦**: è¿‘ä¼¼O(1) - ä»Top 25(0.003ç§’)åˆ°Top 100(0.041ç§’)ï¼Œä»…å¢åŠ 13.7å€
- **ç†è®ºvså®é™…**: è¿œä½äºç†è®ºO(nÂ³)å¤æ‚åº¦ï¼ˆåº”å¢åŠ 64å€ï¼‰
- **åŸå› **: ç°ä»£BLASåº“é«˜åº¦ä¼˜åŒ–ï¼Œå°çŸ©é˜µå®Œå…¨åœ¨CPUç¼“å­˜ä¸­å¤„ç†
- **ç»“è®º**: SVDä¸æ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œåº“ä¼˜åŒ–ä½¿å…¶æ¥è¿‘å¸¸æ•°æ—¶é—´

**2. çŸ©é˜µæ„å»ºæ€§èƒ½ç‰¹å¾**ï¼š
- **å®é™…å¤æ‚åº¦**: O(nÂ²) - ä»Top 25(0.07ç§’)åˆ°Top 100(17.7ç§’)ï¼Œå¢åŠ 253å€
- **ç†è®ºéªŒè¯**: Top 25â†’50â†’100ï¼Œå€æ•°å…³ç³»ä¸º1:20:253ï¼Œç¬¦åˆO(nÂ²)ç‰¹å¾
- **æ€§èƒ½å æ¯”**: åœ¨å¤§çŸ©é˜µä¸‹æˆä¸ºä¸»è¦ç“¶é¢ˆï¼ˆTop 100å 53.6%ï¼‰
- **ç»“è®º**: å®é™…å¢é•¿ç•¥é«˜äºç†è®ºï¼Œå¯èƒ½æ˜¯å†…å­˜è®¿é—®æ¨¡å¼å½±å“

**3. Bootstrapé‡é‡‡æ ·æ€§èƒ½ç‰¹å¾**ï¼š
- **å®é™…å¤æ‚åº¦**: O(nÂ²) - ä»Top 25(0.35ç§’)åˆ°Top 100(7.13ç§’)ï¼Œå¢åŠ 20.4å€
- **ç†è®ºéªŒè¯**: ç¬¦åˆO(nÂ²)ç‰¹å¾ï¼Œä½†å¢é•¿ç›¸å¯¹è¾ƒæ…¢
- **æ€§èƒ½å æ¯”**: å§‹ç»ˆå è°±æ’åºæ—¶é—´çš„40-50%
- **ç»“è®º**: ä¸»è¦è®¡ç®—è´Ÿè½½ï¼Œå…·å¤‡å¹¶è¡Œä¼˜åŒ–æ½œåŠ›

**4. Uniform CIè®¡ç®—æ€§èƒ½ç‰¹å¾**ï¼š
- **å®é™…å¤æ‚åº¦**: O(nÂ²) - ä»Top 25(0.26ç§’)åˆ°Top 100(6.41ç§’)ï¼Œå¢åŠ 24.7å€
- **æ€§èƒ½å æ¯”**: åœ¨å¤§çŸ©é˜µä¸‹æ˜¾è‘—å¢åŠ ï¼ˆTop 100å 19.4%ï¼‰
- **ç»“è®º**: ç»Ÿè®¡è®¡ç®—å¼€é”€éšçŸ©é˜µè§„æ¨¡å¿«é€Ÿå¢é•¿

##### å¤æ‚åº¦ç†è®ºvså®é™…å¯¹æ¯”

**ç†è®ºå¤æ‚åº¦é¢„æœŸ**ï¼š
- **SVD**: O(nÂ³) - åº”éšnÂ³å¿«é€Ÿå¢é•¿
- **çŸ©é˜µæ„å»º**: O(nÂ²) - åº”éšnÂ²å¢é•¿
- **Bootstrap**: O(BÃ—nÂ²) - åº”éšnÂ²å¢é•¿
- **Uniform CI**: O(nÂ²) - åº”éšnÂ²å¢é•¿

**å®é™…æµ‹é‡ç»“æœ**ï¼š
- **SVDå®é™…å¤æ‚åº¦**: è¿‘ä¼¼O(1)ï¼Œè¿œä½äºç†è®ºO(nÂ³)
- **çŸ©é˜µæ„å»ºå®é™…å¤æ‚åº¦**: O(nÂ²)ï¼Œç¬¦åˆç†è®ºé¢„æœŸ
- **Bootstrapå®é™…å¤æ‚åº¦**: O(nÂ²)ï¼Œç¬¦åˆç†è®ºé¢„æœŸ
- **Uniform CIå®é™…å¤æ‚åº¦**: O(nÂ²)ï¼Œç¬¦åˆç†è®ºé¢„æœŸ

**Optimization Opportunities**ï¼š
1.  **çŸ©é˜µæ„å»ºä¼˜åŒ– (é¦–è¦ä»»åŠ¡)**:
    *   **å‘é‡åŒ–è®¡ç®— (Vectorized Computation)**: è¿™æ˜¯æœ€ç›´æ¥ä¸”æœ€æœ‰æ•ˆçš„ä¼˜åŒ–æ‰‹æ®µã€‚å½“å‰ `O(nÂ²)` çš„ç“¶é¢ˆä¸»è¦æ¥è‡ªçŸ©é˜µæ„å»ºè¿‡ç¨‹ã€‚é€šè¿‡ä½¿ç”¨ R è¯­è¨€å†…ç½®çš„å‘é‡å’ŒçŸ©é˜µæ“ä½œï¼Œæ›¿ä»£æ˜¾å¼ `for` å¾ªç¯ï¼Œå¯ä»¥åˆ©ç”¨åº•å±‚é«˜åº¦ä¼˜åŒ–çš„ C/Fortran ä»£ç æ‰§è¡Œè®¡ç®—ï¼Œä»è€Œå¤§å¹…å‡å°‘ R è§£é‡Šå™¨çš„å¼€é”€ã€‚è¿™æ˜¯è§£å†³æ€§èƒ½é—®é¢˜çš„é¦–é€‰æ–¹æ¡ˆã€‚
    *   **GPU åŠ é€Ÿ**: å¯¹äºæ›´å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ”¯æŒ GPU çš„åº“ï¼ˆå¦‚ `gpuR`ï¼‰å°†çŸ©é˜µè¿ç®— offload åˆ° GPU ä¸Šæ‰§è¡Œï¼Œä½†è¿™éœ€è¦é¢å¤–çš„ç¡¬ä»¶å’Œä¾èµ–é…ç½®ã€‚
2.  **Bootstrap å¹¶è¡ŒåŒ–**:
    *   Bootstrap è¿‡ç¨‹å ç”¨äº†çº¦ 40-50% çš„è®¡ç®—æ—¶é—´ï¼Œä¸”æ¯æ¬¡è¿­ä»£éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚å› æ­¤ï¼Œä½¿ç”¨ `parallel` æˆ– `future` åŒ…å°† `B=2000` æ¬¡é‡é‡‡æ ·åˆ†é…åˆ°å¤šä¸ª CPU æ ¸å¿ƒä¸Šå¹¶è¡Œæ‰§è¡Œï¼Œå¯ä»¥å‡ ä¹çº¿æ€§åœ°å‡å°‘è¿™éƒ¨åˆ†æ‰€éœ€çš„æ—¶é—´ã€‚

### 5.5. Arena Human Preference Dataset (æ–°å¢æ•°æ®æº)

Arenaæ•°æ®é›†æä¾›äº†åŸºäºäººç±»åå¥½çš„LLMæ¨¡å‹æ¯”è¾ƒæ•°æ®ï¼Œä¸ä¼ ç»ŸåŸºå‡†æµ‹è¯•å½¢æˆäº’è¡¥ã€‚

#### æ•°æ®æº
- **Dataset**: `lmarena-ai/arena-human-preference-140k`
- **æ¥æº**: Hugging Face Datasets
- **æ•°æ®è§„æ¨¡**: 136,634æ¡å®Œæ•´è®°å½•
- **é‡‡é›†æ ·æœ¬**: 136,634æ¡å®Œæ•´è®°å½•

#### Schemaç»“æ„ (14åˆ—)

**æ ¸å¿ƒæ¯”è¾ƒå­—æ®µ**ï¼š
- `id` (string): å”¯ä¸€æŠ•ç¥¨æ ‡è¯†ç¬¦ï¼ŒUUIDæ ¼å¼
- `model_a` (string): ç¬¬ä¸€ä¸ªè¢«æ¯”è¾ƒçš„æ¨¡å‹ï¼ˆå¦‚ï¼š`gemini-2.5-pro`ï¼‰
- `model_b` (string): ç¬¬äºŒä¸ªè¢«æ¯”è¾ƒçš„æ¨¡å‹ï¼ˆå¦‚ï¼š`claude-3-7-sonnet-20250219-thinking-32k`ï¼‰
- `winner` (string): æŠ•ç¥¨ç»“æœï¼Œå¯é€‰å€¼ï¼š`model_a`ã€`model_b`ã€`tie`ã€`both_bad`

**ä¼šè¯ç®¡ç†å­—æ®µ**ï¼š
- `evaluation_session_id` (string): è¯„ä¼°æ‰¹æ¬¡æ ‡è¯†ç¬¦
- `evaluation_order` (int64): ä¼šè¯å†…çš„è¯„ä¼°é¡ºåº

**å¯¹è¯å†…å®¹å­—æ®µ**ï¼š
- `conversation_a` (JSON): model_açš„å®Œæ•´å¯¹è¯å†å²
- `conversation_b` (JSON): model_bçš„å®Œæ•´å¯¹è¯å†å²
- `full_conversation` (JSON): åˆå¹¶çš„ç”¨æˆ·é—®é¢˜å’ŒåŒæ¨¡å‹å›ç­”

**å…ƒæ•°æ®å­—æ®µ**ï¼š
- `conv_metadata` (JSON): å¯¹è¯ç»Ÿè®¡ä¿¡æ¯ï¼ˆTokenæ•°ã€æ ¼å¼ç»Ÿè®¡ç­‰ï¼‰
- `category_tag` (JSON): å†…å®¹åˆ†ç±»æ ‡ç­¾ï¼ˆå¦‚åˆ›æ„å†™ä½œã€æ•°å­¦æ¨ç†ç­‰ï¼‰
- `language` (string): å¯¹è¯ä¸»è¦è¯­è¨€ï¼ˆä¸»è¦`en`ï¼Œä¹ŸåŒ…å«`pl`ã€`de`ç­‰ï¼‰
- `is_code` (bool): æ˜¯å¦æ¶‰åŠç¼–ç¨‹ä»£ç 
- `timestamp` (string): è¯„ä¼°æ—¶é—´æˆ³ï¼ˆISOæ ¼å¼ï¼‰

#### æ•°æ®ç‰¹ç‚¹
- **å¤šè¯­è¨€æ”¯æŒ**: è‹±è¯­ã€æ³¢å…°è¯­ã€å¾·è¯­ç­‰å¤šè¯­è¨€å¯¹è¯
- **ä¸°å¯Œå…ƒæ•°æ®**: Tokenç»Ÿè®¡ã€å†…å®¹åˆ†ç±»ã€æ ¼å¼åˆ†æç­‰
- **å¯¹è¯è´¨é‡è¯„ä¼°**: åŸºäºäººç±»åå¥½çš„ä¸»è§‚è´¨é‡åˆ¤æ–­
- **æ—¶é—´åºåˆ—**: æ”¯æŒæ¨¡å‹æ€§èƒ½è¶‹åŠ¿åˆ†æ

#### åˆ†æä»·å€¼
Arenaæ•°æ®é›†ä¸Open LLM Leaderboardå½¢æˆäº’è¡¥ï¼š
- **Leaderboard**: å®¢è§‚åŸºå‡†æµ‹è¯•åˆ†æ•°ï¼ˆIFEvalã€BBHã€MATHç­‰ï¼‰
- **Arena**: ä¸»è§‚äººç±»åå¥½æŠ•ç¥¨ï¼ˆå¯¹è¯è´¨é‡ã€ç”¨æˆ·ä½“éªŒï¼‰

#### æ•°æ®æ–‡ä»¶ä½ç½®
```
data_llm/data_arena/data_collection/
â”œâ”€â”€ arena_human_preference_sample_100.csv          # æ ·æœ¬æ•°æ®
â”œâ”€â”€ arena_human_preference_sample_100_metadata.json # åˆ†æå…ƒæ•°æ®
â””â”€â”€ ARENA_DATASET_SCHEMA.md                        # è¯¦ç»†schemaæ–‡æ¡£
```

#### æœªæ¥é›†æˆè®¡åˆ’
1. **æ•°æ®å¤„ç†è„šæœ¬**: `arena_data_process.py` - è½¬æ¢ä¸ºè°±æ’åºæ ¼å¼
2. **æ’ååˆ†æè„šæœ¬**: `arena_ranking.py` - æ‰§è¡Œè°±æ’åºç®—æ³•
3. **Dashboardé›†æˆ**: åœ¨Webç•Œé¢ä¸­æ·»åŠ Arenaæ•°æ®å¯è§†åŒ–
4. **è”åˆåˆ†æ**: æ¢ç´¢Leaderboardåˆ†æ•°ä¸Arenaåå¥½çš„ç›¸å…³æ€§

### 5.6. Arenaæ•°æ®é›†7ä¸ªä»»åŠ¡åˆ†ç±»ç»´åº¦çš„åˆ¤å®šæ ‡å‡†

åŸºäºChatbot Arenaå®˜æ–¹å®šä¹‰ï¼ŒArenaæ•°æ®é›†æ”¯æŒ7ä¸ªä»»åŠ¡åˆ†ç±»ç»´åº¦ï¼Œç”¨äºæ›´ç»†ç²’åº¦çš„æ¨¡å‹æ€§èƒ½åˆ†æï¼š

**å‚è€ƒèµ„æ–™**: [Chatbot Arena Categories: Definitions, Methods, and Insights](https://news.lmarena.ai/arena-category/)

#### ğŸ¨ **1. Creative Writing (åˆ›æ„å†™ä½œ)**
- **åˆ¤å®šå­—æ®µ**: `category_tag['creative_writing_v0.1']['creative_writing'] == True`
- **å®šä¹‰**: è¯„ä¼°æ¨¡å‹åˆ›ä½œåŸåˆ›ã€æœ‰æƒ³è±¡åŠ›å’Œæƒ…æ„Ÿå…±é¸£å†…å®¹çš„èƒ½åŠ›
- **åˆ¤å®šæ ‡å‡†**:
  - éœ€è¦åŸåˆ›æ€§å’Œæƒ³è±¡åŠ›
  - æ¶‰åŠæƒ…æ„Ÿæˆ–è‰ºæœ¯è¡¨è¾¾
  - è¯·æ±‚ç‹¬ç‰¹è§†è§’æˆ–è§£é‡Šæ€§å“åº”
  - è¶…è¶Šäº‹å®æŠ¥å‘Šæˆ–åˆ†æçš„å†™ä½œ

#### ğŸ”¢ **2. Math (æ•°å­¦æ¨ç†)**
- **åˆ¤å®šå­—æ®µ**: `category_tag['math_v0.1']['math'] == True`
- **å®šä¹‰**: è¯„ä¼°æ¨¡å‹åº”ç”¨æ•°å­¦æ¨ç†å’Œé—®é¢˜è§£å†³æŠ€èƒ½çš„èƒ½åŠ›
- **åˆ¤å®šæ ‡å‡†**:
  - éœ€è¦ä¸»åŠ¨åº”ç”¨æ•°å­¦æ¦‚å¿µ
  - æ¶‰åŠæ•°å€¼è®¡ç®—ã€ä»£æ•°è¿ç®—æˆ–å‡ ä½•æ¨ç†
  - åŒ…å«æ¸…æ™°ã€æ˜ç¡®çš„é—®é¢˜
  - æµ‹è¯•ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­¦èƒ½åŠ›

#### ğŸ“‹ **3. Instruction Following (æŒ‡ä»¤è·Ÿéš)**
- **åˆ¤å®šå­—æ®µ**: `category_tag['if_v0.1']['if'] == True`
- **å®šä¹‰**: è¯„ä¼°æ¨¡å‹ç²¾ç¡®éµå¾ªç»™å®šæŒ‡ä»¤çš„èƒ½åŠ›
- **åˆ¤å®šæ ‡å‡†**:
  - æ¸…æ™°ã€å¯æ“ä½œçš„ç”¨æˆ·æŒ‡ä»¤
  - ç‰¹å®šçš„æ ¼å¼æˆ–ç»“æ„è¦æ±‚
  - ç‹¬ç‰¹æˆ–å…·æœ‰æŒ‘æˆ˜æ€§çš„æ–¹é¢

#### ğŸ’» **4. Coding (ç¼–ç¨‹)**
- **åˆ¤å®šå­—æ®µ**: `is_code == True`
- **å®šä¹‰**: è¯„ä¼°æ¨¡å‹ç†è§£ã€ç”Ÿæˆå’Œè°ƒè¯•ä»£ç çš„èƒ½åŠ›
- **åˆ¤å®šæ ‡å‡†**: å¯å‘å¼ç®—æ³•æ£€æµ‹ä»£ç ç›¸å…³å†…å®¹
  - ä»£ç å—æ ‡è®°
  - ç¼–ç¨‹è¯­è¨€å…³é”®è¯
  - ä»£ç å‘½ä»¤å’Œç›¸å…³æœ¯è¯­

#### ğŸš€ **5. Hard Prompt (å›°éš¾æç¤º)**
- **åˆ¤å®šé€»è¾‘**: æ»¡è¶³è‡³å°‘6ä¸ªä»¥ä¸‹7ä¸ªæ ¸å¿ƒç»´åº¦çš„è¦æ±‚
- **å®šä¹‰**: å¤„ç†å¤æ‚ã€ä¸¥æ ¼ã€ç²¾å¿ƒè®¾è®¡çš„æç¤º
- **7ä¸ªæ ¸å¿ƒç»´åº¦**:
  1. **Specificity**: æ˜¯å¦è¦æ±‚ç‰¹å®šè¾“å‡ºï¼Ÿ
  2. **Domain Knowledge**: æ˜¯å¦æ¶‰åŠä¸€ä¸ªæˆ–å¤šä¸ªç‰¹å®šé¢†åŸŸï¼Ÿ
  3. **Complexity**: æ˜¯å¦å…·æœ‰å¤šä¸ªæ¨ç†å±‚æ¬¡ã€ç»„ä»¶æˆ–å˜é‡ï¼Ÿ
  4. **Problem-Solving**: æ˜¯å¦éœ€è¦ä¸»åŠ¨é—®é¢˜è§£å†³æŠ€èƒ½ï¼Ÿ
  5. **Creativity**: æ˜¯å¦éœ€è¦åˆ›é€ æ€§è§£å†³é—®é¢˜ï¼Ÿ
  6. **Technical Accuracy**: æ˜¯å¦éœ€è¦æŠ€æœ¯å‡†ç¡®æ€§ï¼Ÿ
  7. **Real-world Application**: æ˜¯å¦æ¶‰åŠç°å®åº”ç”¨ï¼Ÿ

```python
# Hard Promptåˆ¤å®šä»£ç 
def is_hard_prompt(category_tag):
    criteria = category_tag.get('criteria_v0.1', {})
    hard_score = sum([
        criteria.get('specificity', False),
        criteria.get('domain_knowledge', False),
        criteria.get('complexity', False),
        criteria.get('problem_solving', False),
        criteria.get('creativity', False),
        criteria.get('technical_accuracy', False),
        criteria.get('real_world', False)
    ])
    return hard_score >= 6
```

**å‚è€ƒèµ„æ–™**: [Introducing Hard Prompts Category in Chatbot Arena](https://lmsys.org/blog/2024-05-17-category-hard/)

#### ğŸ“ **6. Longer Query (é•¿æŸ¥è¯¢)**
- **åˆ¤å®šé€»è¾‘**: `conv_metadata['sum_user_tokens'] > 500`
- **å®šä¹‰**: æŸ¥è¯¢é•¿åº¦è¶…è¿‡500 tokensï¼ˆçº¦å å…¨éƒ¨æç¤ºçš„10%ï¼‰
- **åˆ¤å®šæ ‡å‡†**: åŸºäºç”¨æˆ·è¾“å…¥çš„tokenæ•°é‡é˜ˆå€¼

#### ğŸ”„ **7. Multi-Turn (å¤šè½®å¯¹è¯)**
- **åˆ¤å®šé€»è¾‘**: `conv_metadata['turns'] > 1`
- **å®šä¹‰**: å¤šè½®å¯¹è¯äº¤äº’
- **åˆ¤å®šæ ‡å‡†**: å¯¹è¯è½®æ•°è¶…è¿‡1è½®

#### ğŸ“Š **åˆ†ç±»éƒ¨ç½²è¯´æ˜**
- **å‰4ä¸ªç»´åº¦**: åŸºäºé¢„å®šä¹‰çš„åˆ†ç±»æ ‡ç­¾å­—æ®µç›´æ¥åˆ¤æ–­
- **å3ä¸ªç»´åº¦**: é€šè¿‡å…ƒæ•°æ®ç»Ÿè®¡å’Œå†…å®¹ç‰¹å¾æ¨æ–­åˆ¤æ–­
- **Hard Prompt**: éœ€è¦æ»¡è¶³è‡³å°‘6ä¸ªè¯„ä¼°ç»´åº¦çš„ç»„åˆåˆ¤æ–­
- **æ•°æ®æ¥æº**: æ‰€æœ‰åˆ¤å®šä¿¡æ¯å‡æ¥è‡ª`category_tag`å’Œ`conv_metadata`å­—æ®µ

è¿™äº›åˆ†ç±»ç»´åº¦ä¸ºArenaæ•°æ®é›†æä¾›äº†ç»†ç²’åº¦çš„ä»»åŠ¡åˆ†æèƒ½åŠ›ï¼Œæ”¯æŒæ¨¡å‹æ€§èƒ½çš„æ·±åº¦è¯„ä¼°å’Œæ¯”è¾ƒã€‚


### 5.7. Arena æ•°æ®çš„ BT-MLE å»ºæ¨¡ä¸è°±æ’åºé›†æˆï¼ˆæ›¿ä»£ win_rateï¼‰

ä¸ºæå‡ä¸¥æ ¼æ€§ä¸ç¨³å¥æ€§ï¼Œæœ¬é¡¹ç›®åœ¨ `arena_data_process.py` ä¸­é‡‡ç”¨ Bradleyâ€“Terryï¼ˆBTï¼‰æ¨¡å‹å¯¹ Arena çš„äººç±»åå¥½æŠ•ç¥¨è¿›è¡Œç±»åˆ«çº§å»ºæ¨¡ï¼Œå¹¶å°†æ¯ä¸ªç±»åˆ«çš„ BT æ¦‚ç‡ä½œä¸ºè°±æ’åºè¾“å…¥ï¼ˆ7 è¡Œâ€œè™šæ‹ŸåŸºå‡†â€ï¼‰ã€‚æ ¸å¿ƒè¦ç‚¹å¦‚ä¸‹ï¼š

- ä¸ºä»€ä¹ˆä¸ç”¨ç®€å• win_rateï¼š
  - **å¯¹æ‰‹å¼ºåº¦æ ¡æ­£**ï¼šBT åœ¨æˆå¯¹æ¯”è¾ƒå±‚é¢ç»Ÿä¸€ä¼°è®¡æ¯ä¸ªæ¨¡å‹çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿè‡ªç„¶æ ¡æ­£â€œé‡åˆ°å¼º/å¼±å¯¹æ‰‹â€å¸¦æ¥çš„åå·®ã€‚
  - **å°æ ·æœ¬æ›´ç¨³å¥**ï¼šå¯ä»¥å¼•å…¥è½»é‡å…ˆéªŒ/å¹³æ»‘ï¼Œé¿å…ç¨€ç–ç±»åˆ«ä¸‹çš„æç«¯æ¯”å€¼ï¼›æ¯”åŸå§‹èƒœç‡æ›´ç¨³å®šã€‚
  - **å¹³å±€å¤„ç†ä¸€è‡´**ï¼šä¸ Arena åšæ³•ä¸€è‡´ï¼Œå°†å¹³å±€è®¡ä½œâ€œå„ 0.5 èƒœâ€ã€‚

- æ¨¡å‹å…¬å¼ï¼ˆLogit å½¢å¼ï¼‰ï¼š
  - ä»»æ„ä¸¤æ¨¡å‹ \(i, j\) çš„èƒœç‡ä¸º
    \[\Pr(i > j) = \sigma(\theta_i - \theta_j) = \frac{\exp(\theta_i)}{\exp(\theta_i)+\exp(\theta_j)}.\]
  - å¯è¾¨è¯†æ€§é€šè¿‡çº¦æŸï¼ˆå¦‚ \(\sum_i \theta_i = 0\)ï¼‰æˆ–å‡ ä½•å‡å€¼å½’ä¸€åŒ–è§£å†³ã€‚
  - å¹³å±€å¤„ç†ï¼šå°† tie æŒ‰ 0.5/0.5 åˆ†æ‘Šåˆ°åŒæ–¹çš„èƒœåœºï¼›`both_bad` è§†ä½œç¼ºå¤±ï¼ˆä¸è¿›å…¥ä¼¼ç„¶ï¼‰ã€‚
  - æœ¬å®ç°é‡‡ç”¨ MMï¼ˆMinorizeâ€“Maximizeï¼‰è¿­ä»£è¿›è¡Œæå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œå¹¶åŠ å…¥è½»é‡å¹³æ»‘ï¼ˆé»˜è®¤ä¸º \(\alpha=0.5\)ï¼‰ã€‚

- ç±»åˆ«çº§å»ºæ¨¡ä¸è¾“å‡ºï¼š
  - å¯¹ 7 ä¸ªä»»åŠ¡ç±»åˆ«åˆ†åˆ«æ‹Ÿåˆ BTï¼Œè¾“å‡ºå¯¹â€œå¹³å‡å¯¹æ‰‹â€çš„èƒœç‡åˆ»åº¦ \(p_i = s_i/(s_i+1)\)ã€‚
  - ç”Ÿæˆçš„ 7 è¡Œè™šæ‹ŸåŸºå‡†ä¸ºï¼š
    - `creative_writing_bt_prob`
    - `math_bt_prob`
    - `instruction_following_bt_prob`
    - `coding_bt_prob`
    - `hard_prompt_bt_prob`
    - `longer_query_bt_prob`
    - `multi_turn_bt_prob`
  - é—¨æ§›ä¸å›é€€ï¼šæ•´ä½“æœ€å°‘å¯¹å±€æ•° `MIN_GAMES_THRESHOLD=5`ï¼›ç±»åˆ«å†…æœ€å°‘å¯¹å±€æ•°ä¸º 3ã€‚è‹¥ç±»åˆ«å¯¹å±€ä¸è¶³æˆ–æ— æ³•ä¼°è®¡ï¼Œåˆ™åœ¨å¯¼å‡ºçŸ©é˜µæ—¶ä»¥ 0.5 ä½œä¸ºâ€œä¸­æ€§å€¼â€å›é€€ã€‚

- ä¸è°±æ’åºçš„å…³ç³»ï¼ˆä¸ä¼šé‡å¤ï¼‰ï¼š
  - BT è§£å†³â€œç±»åˆ«å†…ï¼šæŠ•ç¥¨â†’èƒ½åŠ›åˆ»åº¦â€çš„é—®é¢˜ï¼›è°±æ’åºè§£å†³â€œè·¨ç±»åˆ«ï¼šå¤šè¡Œæ ·æœ¬â†’æ€»ä½“ç¨³å¥æ’åä¸åŒºé—´â€çš„é—®é¢˜ï¼Œå±‚çº§ä¸åŒï¼Œä¸æ˜¯é‡å¤å»ºæ¨¡ã€‚
  - è‹¥åªéœ€è¦ä¸€ä¸ªâ€œå…¨å±€â€åå¥½è¯„åˆ†ï¼Œå¯ç›´æ¥ç”¨â€œå…¨å±€ BTâ€ï¼›ä½†æœ¬é¡¹ç›®çš„ç›®æ ‡æ˜¯åˆ©ç”¨ 7 ç±»ä¿¡æ¯è¿›è¡Œç¨³å¥èšåˆä¸ä¸ç¡®å®šæ€§é‡åŒ–ï¼Œå› æ­¤é‡‡ç”¨â€œç±»åˆ« BT â†’ è°±æ’åºâ€ã€‚

- ä¸ LMSYS çš„åšæ³•ä¸€è‡´ä¸”å¯æ˜ å°„åˆ° Elo åˆ»åº¦ï¼š
  - LMSYS å·²ä»åœ¨çº¿ Elo è¿ç§»åˆ°é›†ä¸­å¼ BT-MLEï¼Œå¹¶å°†å¹³å±€æŒ‰ 0.5 è®¡å…¥ï¼›å±•ç¤ºä¸Šä»ç”¨ Elo åˆ»åº¦ä»¥ä¿æŒè¿ç»­æ€§ã€‚
  - ä¸¤ç§åˆ»åº¦ç­‰ä»·ï¼š\( \Pr(i>j) = 1/(1+10^{(R_j-R_i)/400}) \) ä¸ä¸Šå¼çº¿æ€§å¯¹åº”ï¼Œ\( \theta_i = (\ln 10/400)\,R_i + c \)ã€‚
  - å‚è€ƒï¼š [Chatbot Arena: New models & Elo system update](https://lmsys.org/blog/2023-12-07-leaderboard/)

- å®è·µå‚æ•°ï¼ˆå½“å‰å®ç°ï¼‰ï¼š
  - å¹³æ»‘ï¼š\(\alpha=0.5\)ï¼ˆJeffreys/Laplace é£æ ¼ï¼Œé¿å…é›¶é”æ­»ï¼‰
  - æ”¶æ•›ï¼šMM æœ€å¤§è¿­ä»£ 5000ï¼Œå®¹å·® \(1e{-8}\)
  - å½’ä¸€åŒ–ï¼šå‡ ä½•å‡å€¼ä¸º 1ï¼ˆå¹³å‡å¯¹æ‰‹å¼ºåº¦ä¸º 1ï¼‰

#### 5.7.1. æ•°æ®äº§ç‰©ä¸è·¯å¾„

- å¤„ç†è„šæœ¬ï¼š`code_app/backend/data_processing/arena_data_process.py`
- è¾“å‡º CSVï¼š`data_llm/data_arena/data_processing/arena_ranking_full.csv`
  - è¡Œï¼šä¸Šè¿° 7 ä¸ª `*_bt_prob`
  - åˆ—ï¼šæ¸…æ´—åçš„æ¨¡å‹å
- å…ƒæ•°æ®ï¼šåŒè·¯å¾„ä¸‹ `_metadata.json`ï¼Œè®°å½•é˜ˆå€¼ä¸å­—æ®µè¯´æ˜ã€‚

#### 5.7.2. æ¨¡å‹å‚èµ›ç»Ÿè®¡

åŸºäº 135,634 åœºæ¯”èµ›çš„æ•°æ®ç»Ÿè®¡ï¼Œæ€»å…±æœ‰ 53 ç§ç‹¬ç‰¹æ¨¡å‹å‚ä¸æ¯”èµ›ã€‚

| æ’å | æ¨¡å‹åç§° | model_aæ¬¡æ•° | model_bæ¬¡æ•° | æ€»æ¯”èµ›æ¬¡æ•° |
|------|---------|-------------|-------------|------------|
| 1 | claude-opus-4-20250514 | 4957 | 5135 | 10092 |
| 2 | gemini-2.5-flash | 4911 | 4757 | 9668 |
| 3 | gemini-2.5-pro | 4576 | 4643 | 9219 |
| 4 | mistral-medium-2505 | 4599 | 4536 | 9135 |
| 5 | qwen3-235b-a22b-no-thinking | 4561 | 4515 | 9076 |
| 6 | o3-2025-04-16 | 4272 | 4257 | 8529 |
| 7 | claude-sonnet-4-20250514 | 4130 | 4165 | 8295 |
| 8 | chatgpt-4o-latest-20250326 | 3816 | 3834 | 7650 |
| 9 | gemma-3-27b-it | 3675 | 3651 | 7326 |
| 10 | claude-3-7-sonnet-20250219-thinking-32k | 3530 | 3619 | 7149 |
| 11 | claude-3-7-sonnet-20250219 | 3409 | 3443 | 6852 |
| 12 | command-a-03-2025 | 3463 | 3375 | 6838 |
| 13 | claude-3-5-sonnet-20241022 | 3316 | 3501 | 6817 |
| 14 | o3-mini | 3279 | 3345 | 6624 |
| 15 | deepseek-r1-0528 | 3290 | 3264 | 6554 |
| 16 | gpt-4.1-2025-04-14 | 3254 | 3286 | 6540 |
| 17 | o4-mini-2025-04-16 | 3250 | 3227 | 6477 |
| 18 | claude-3-5-haiku-20241022 | 3210 | 3256 | 6466 |
| 19 | amazon.nova-pro-v1:0 | 3218 | 3165 | 6383 |
| 20 | claude-opus-4-20250514-thinking-16k | 3149 | 3008 | 6157 |
| 21 | gpt-4.1-mini-2025-04-14 | 3061 | 3060 | 6121 |
| 22 | deepseek-v3-0324 | 3020 | 3097 | 6117 |
| 23 | gemini-2.0-flash-001 | 3137 | 2937 | 6074 |
| 24 | grok-3-preview-02-24 | 3021 | 3019 | 6040 |
| 25 | grok-3-mini-beta | 2992 | 2999 | 5991 |
| 26 | llama-4-maverick-03-26-experimental | 2844 | 2962 | 5806 |
| 27 | claude-sonnet-4-20250514-thinking-32k | 2838 | 2775 | 5613 |
| 28 | qwen3-30b-a3b | 2807 | 2691 | 5498 |
| 29 | minimax-m1 | 2726 | 2743 | 5469 |
| 30 | llama-4-maverick-17b-128e-instruct | 2614 | 2718 | 5332 |
| 31 | gemini-2.5-flash-lite-preview-06-17-thinking | 2583 | 2649 | 5232 |
| 32 | qwen3-235b-a22b | 2593 | 2522 | 5115 |
| 33 | gemini-2.5-flash-preview-04-17 | 2571 | 2479 | 5050 |
| 34 | llama-3.3-70b-instruct | 2457 | 2448 | 4905 |
| 35 | qwen-max-2025-01-25 | 2153 | 2226 | 4379 |
| 36 | qwq-32b | 2112 | 2147 | 4259 |
| 37 | mistral-small-3.1-24b-instruct-2503 | 1636 | 1635 | 3271 |
| 38 | amazon-nova-experimental-chat-05-14 | 1658 | 1609 | 3267 |
| 39 | gemini-2.5-pro-preview-05-06 | 1648 | 1607 | 3255 |
| 40 | llama-4-scout-17b-16e-instruct | 1370 | 1435 | 2805 |
| 41 | grok-3-mini-high | 1427 | 1374 | 2801 |
| 42 | kimi-k2-0711-preview | 1364 | 1379 | 2743 |
| 43 | gemma-3n-e4b-it | 1271 | 1340 | 2611 |
| 44 | magistral-medium-2506 | 1307 | 1299 | 2606 |
| 45 | mistral-small-2506 | 1201 | 1172 | 2373 |
| 46 | hunyuan-turbos-20250416 | 817 | 768 | 1585 |
| 47 | grok-4-0709 | 802 | 759 | 1561 |
| 48 | gemini-2.5-pro-preview-03-25 | 635 | 754 | 1389 |
| 49 | qwen3-235b-a22b-instruct-2507 | 306 | 316 | 622 |
| 50 | gpt-4o-mini-2024-07-18 | 319 | 271 | 590 |
| 51 | gpt-4o-2024-11-20 | 286 | 287 | 573 |
| 52 | gemini-2.0-flash-thinking-exp-01-21 | 192 | 174 | 366 |
| 53 | qwen3-coder-480b-a35b-instruct | 1 | 1 | 2 |

**ç»Ÿè®¡è¯´æ˜ï¼š**
- **model_aæ¬¡æ•°**: è¯¥æ¨¡å‹ä½œä¸ºç¬¬ä¸€ä¸ªå€™é€‰æ¨¡å‹å‡ºç°çš„æ¬¡æ•°
- **model_bæ¬¡æ•°**: è¯¥æ¨¡å‹ä½œä¸ºç¬¬äºŒä¸ªå€™é€‰æ¨¡å‹å‡ºç°çš„æ¬¡æ•°
- **æ€»æ¯”èµ›æ¬¡æ•°**: è¯¥æ¨¡å‹å‚ä¸çš„æ€»æ¯”èµ›åœºæ¬¡
- æ’åæŒ‰æ€»æ¯”èµ›æ¬¡æ•°é™åºæ’åˆ—

**æ•°æ®æ´å¯Ÿï¼š**
- æœ€æ´»è·ƒçš„æ¨¡å‹ `claude-opus-4-20250514` å‚åŠ äº† 10,092 åœºæ¯”èµ›
- å¤§å¤šæ•°ä¸»æµæ¨¡å‹ï¼ˆå¦‚Geminiã€Claudeã€GPTç³»åˆ—ï¼‰éƒ½æœ‰æ•°åƒåœºå‚èµ›è®°å½•
- å‚èµ›æ¬¡æ•°åˆ†å¸ƒå‘ˆç°æ˜æ˜¾çš„é•¿å°¾æ•ˆåº”ï¼Œå‰10åæ¨¡å‹å æ®äº†å¤§éƒ¨åˆ†æ¯”èµ›